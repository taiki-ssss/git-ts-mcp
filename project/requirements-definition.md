# 要件定義書

## プロジェクト概要

Git操作を可能にするMCPサーバーの実装

## 機能要件

### 1. Gitコミット機能

#### 概要
MCPクライアントからGitリポジトリに対してコミット操作を実行できる機能

#### 詳細要件
- **ツール名**: `git_commit`
- **入力パラメータ**:
  - `repoPath`: Gitリポジトリのパス（必須）
  - `message`: コミットメッセージ（必須）
- **出力**: コミット結果（成功/失敗、コミットハッシュ）

#### 制約事項
- リポジトリが初期化されていること
- 変更があるファイルが存在すること
- コミットメッセージが空でないこと

### 2. Git Status機能

#### 概要
MCPクライアントからGitリポジトリの現在の状態を取得できる機能

#### 詳細要件
- **ツール名**: `git_status`
- **入力パラメータ**:
  - `repoPath`: Gitリポジトリのパス（必須）
- **出力**: リポジトリの状態情報
  - 現在のブランチ名
  - ステージングされたファイル一覧
  - 変更されたファイル一覧
  - 未追跡ファイル一覧
  - リモートとの差分情報（ahead/behind）

#### 制約事項
- 指定されたパスがGitリポジトリであること
- 読み取り権限があること

### 3. Git Add機能

#### 概要
MCPクライアントからファイルをGitのステージングエリアに追加できる機能

#### 詳細要件
- **ツール名**: `git_add`
- **入力パラメータ**:
  - `repoPath`: Gitリポジトリのパス（必須）
  - `files`: 追加するファイルのパスまたはパターンの配列（オプション、デフォルトは全ファイル）
- **出力**: 追加結果
  - 追加されたファイルの一覧
  - 追加されたファイル数
  - エラーがあった場合はその詳細

#### 制約事項
- 指定されたパスがGitリポジトリであること
- 書き込み権限があること
- 指定されたファイルが存在すること（ファイル指定の場合）

### 4. Git Branch List機能

#### 概要
MCPクライアントからGitリポジトリのブランチ一覧を取得できる機能

#### 詳細要件
- **ツール名**: `git_branch_list`
- **入力パラメータ**:
  - `repoPath`: Gitリポジトリのパス（必須）
  - `includeRemote`: リモートブランチを含めるか（オプション、デフォルト: false）
- **出力**: ブランチ情報
  - `current`: 現在のブランチ名
  - `local`: ローカルブランチ名の配列
  - `remote`: リモートブランチ名の配列（includeRemote: true の場合のみ）

#### 制約事項
- 指定されたパスがGitリポジトリであること
- 読み取り権限があること

### 5. Git Branch Create機能 ✅

#### 概要
MCPクライアントからGitリポジトリに新しいブランチを作成できる機能

#### 詳細要件
- **ツール名**: `git_branch_create`
- **入力パラメータ**:
  - `repoPath`: Gitリポジトリのパス（必須）
  - `branchName`: 作成するブランチ名（必須）
  - `baseBranch`: ベースとなるブランチ名（オプション、デフォルト: 現在のHEAD）
  - `checkout`: 作成後にチェックアウトするか（オプション、デフォルト: false）
- **出力**: ブランチ作成結果
  - `success`: 成功フラグ
  - `branchName`: 作成されたブランチ名
  - `baseBranch`: ベースブランチ名
  - `message`: 結果メッセージ
  - `checkedOut`: チェックアウトしたかどうか

#### 制約事項
- 指定されたパスがGitリポジトリであること
- ブランチ名がGitの命名規則に従うこと
- 同名のブランチが存在しないこと
- ベースブランチを指定する場合は、そのブランチが存在すること
- ローカルブランチのみ作成可能

## 非機能要件

### セキュリティ
- 認証情報の安全な管理
- 操作ログの記録

### パフォーマンス
- 大量ファイルのコミットにも対応
- レスポンスタイム: 10秒以内

## 技術スタック
- 言語: TypeScript
- MCPフレームワーク: @modelcontextprotocol/sdk
- Git操作: simple-git
